version: v1.0
name: Monorepo Project
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu1804
blocks:
  - name: Test WEB Server
    task:
      jobs:
        - name: Test
          commands:
            - 'true'
    run:
      when: change_in('/web-app/')
    dependencies: []
  - name: Test iOS Client
    task:
      jobs:
        - name: Test
          commands:
            - 'true'
    run:
      when: change_in('/ios/')
    dependencies: []
  - name: Test docs page
    task:
      prologue:
        commands:
          - checkout
          - sem-version go 1.12
      jobs:
        - name: Test
          commands:
            - 'true'
    run:
      when: change_in('/docs/')
    dependencies: []
  - name: Integration tests
    dependencies:
      - Test WEB Server
      - Test iOS Client
    run:
      when: 'change_in([''/web-app/'', ''/ios/''])'
    task:
      jobs:
        - name: Run tests
          commands:
            - 'true'
